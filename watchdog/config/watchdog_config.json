{
  "system_thresholds": {
    "cpu_percent": 90,
    "memory_percent": 85,
    "disk_percent": 90,
    "swap_percent": 80
  },

  "process_thresholds": {
    "cpu_percent": 65,
    "memory_mb": 1000,
    "memory_percent": 25
  },

  "monitored_processes": {
    "flask_app": {
      "patterns": ["python.*web\\.py", "flask.*app"],
      "max_cpu": 60,
      "max_memory_mb": 800,
      "restart_cmd": "cd /home/ec2-user/workspace/jd_web && bash start.sh -w",
      "critical": true
    },
    "vite_frontend": {
      "patterns": ["node.*vite", "vite.*dev"],
      "max_cpu": 70,
      "max_memory_mb": 800,
      "restart_cmd": null,
      "critical": false,
      "comment": "前端开发服务器，不自动重启"
    },
    "celery_workers": {
      "patterns": ["celery.*worker"],
      "max_cpu": 70,
      "max_memory_mb": 800,
      "restart_cmd": null,
      "critical": false,
      "comment": "Celery 任务队列，不自动重启"
    },
    "vscode_server_core": {
      "patterns": ["node.*server-main", "node.*vscode.*server", "node.*code-server"],
      "max_cpu": 60,
      "max_memory_mb": 500,
      "restart_cmd": null,
      "critical": false,
      "comment": "VSCode核心服务器，允许较高资源使用"
    },
    "vscode_core_extensions": {
      "patterns": ["node.*extensionHost.*python", "node.*pylance", "node.*typescript"],
      "max_cpu": 40,
      "max_memory_mb": 400,
      "restart_cmd": null,
      "critical": false,
      "comment": "核心开发插件(Python, TypeScript)，保持运行"
    },
    "vscode_heavy_extensions": {
      "patterns": ["node.*extensionHost(?!.*python)", "node.*extensionHost.*(?!pylance|typescript)"],
      "max_cpu": 25,
      "max_memory_mb": 200,
      "restart_cmd": null,
      "critical": false,
      "comment": "非核心插件，限制资源使用"
    },
    "vscode_filewatch": {
      "patterns": ["node.*fileWatcher", "node.*ptyHost"],
      "max_cpu": 20,
      "max_memory_mb": 150,
      "restart_cmd": null,
      "critical": false,
      "comment": "文件监控服务，轻量级限制"
    },
    "claude_code": {
      "patterns": ["claude"],
      "max_cpu": 80,
      "max_memory_mb": 800,
      "restart_cmd": null,
      "critical": true,
      "comment": "Claude Code - 主要开发工具，高优先级"
    }
  },

  "protected_processes": [
    "sshd", "systemd", "kernel", "init", "kthread",
    "mariadb", "mysqld", "redis", "system_watchdog",
    "NetworkManager", "chronyd", "dbus"
  ],

  "conditionally_protected_processes": {
    "claude": {
      "memory_threshold_percent": 85,
      "load_average_threshold": 5.0,
      "comment": "Claude Code - 紧急情况下可被终止以保护系统稳定性"
    },
    "node.*server-main": {
      "memory_threshold_percent": 90,
      "load_average_threshold": 7.0,
      "comment": "VS Code 服务器 - 仅极端情况下终止"
    },
    "vscode.*server": {
      "memory_threshold_percent": 90,
      "load_average_threshold": 7.0,
      "comment": "VS Code 相关服务 - 仅极端情况下终止"
    },
    "node.*code-server": {
      "memory_threshold_percent": 90,
      "load_average_threshold": 7.0,
      "comment": "Code Server - 仅极端情况下终止"
    }
  },

  "monitoring": {
    "check_interval": 120,
    "grace_period": 300,
    "max_kills_per_hour": 5,
    "enable_auto_restart": true,
    "enable_notifications": true
  },

  "emergency_thresholds": {
    "memory_percent": 92,
    "disk_percent": 95,
    "load_average": 6.0
  },

  "logging": {
    "log_file": "watchdog/logs/watchdog.log",
    "max_log_size_mb": 20,
    "backup_count": 3
  }
}