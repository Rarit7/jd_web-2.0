#!/usr/bin/env python3
"""
脚本：将dml.sql中的黑词和标签数据写入数据库

用法：
cd /home/ec2-user/workspace/jd_web
python utils/insert_dml_data.py
"""

import sys
import os

# 添加项目根目录到Python路径
project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.insert(0, project_root)

from jd import db
from jd.models.black_keyword import BlackKeyword
from jd.models.result_tag import ResultTag
from datetime import datetime

def insert_black_keywords():
    """插入黑关键词数据"""
    print("开始插入黑关键词数据...")
    
    # 从dml.sql提取的黑关键词数据
    keywords_data = [
        ('财神', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 娱乐', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 发牌', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' bet', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' bet365', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 中奖', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 开奖', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 发财', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 投注', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 澳门', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 赢球', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 博彩', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 体育', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 葡京', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 彩票', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 电玩', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 棋牌', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 太阳城', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 赌', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 冰球', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 金花', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 赌场', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 赌注', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 赌城', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 赌博', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        (' 彩金', 0, 0, '2024-07-18 20:43:25', '2024-07-18 20:43:25'),
        ('约会', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 亚洲', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 牲交', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' av', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 欧美', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 长腿', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 肛交', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 三级', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 成人', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 看片', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 丝袜', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 足浴', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 偷拍', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 调教', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 骚', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 阴毛', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        ('  无码', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 臀', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 屁股', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 性爱', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 情欲', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 巨乳', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 吹箫', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 美乳', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 开档', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 高潮', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 熟女', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 操', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 啪啪', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 偷情', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 做爱', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 出轨', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 性', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 少妇', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        (' 肥臀', 0, 0, '2024-07-18 20:43:45', '2024-07-18 20:43:45'),
        ('毒品', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 兴奋剂', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 摇头丸', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 贩毒', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 可卡因', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 吗啡', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 鸦片', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 白粉', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 镇静剂', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 罂粟', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' drug', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 吸毒者', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 海洛因', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 大麻', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        (' 冰毒', 0, 0, '2024-07-18 20:44:10', '2024-07-18 20:44:10'),
        ('枪', 0, 0, '2024-07-18 20:44:42', '2024-07-18 20:44:42'),
        (' 步枪', 0, 0, '2024-07-18 20:44:42', '2024-07-18 20:44:42'),
        (' 狙击', 0, 0, '2024-07-18 20:44:42', '2024-07-18 20:44:42'),
        (' 汽怆', 0, 0, '2024-07-18 20:44:42', '2024-07-18 20:44:42'),
        (' 气枪', 0, 0, '2024-07-18 20:44:42', '2024-07-18 20:44:42'),
        (' 狙击枪', 0, 0, '2024-07-18 20:44:42', '2024-07-18 20:44:42'),
        ('股票', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 理财', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 算命', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 贵金属', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 贷款', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 集资', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('回收', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 买卖', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 共享', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 账号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 王者', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 荣耀', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 地下城', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 勇士', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 白号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 外国号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 站街号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 瓶子号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 成品号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('分发', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' cdn', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('idc', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('跑分', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('发卡', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 发卡网', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 发卡平台', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 卡密', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('空包', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 物流', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 代发', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 快递', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 单号', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 刷单', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 发货', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 底单', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 空包网', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('兼职', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 在家', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 打字', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 赚钱', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 网赚', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('私服', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 稀有', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 游戏', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('人民', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 国情', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 政府', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 政务', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 制度', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 国家', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 政策', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 机关', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 减税', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('第三方', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 第四方', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 四方', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 聚合', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 支付宝扫码H5', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 微信扫码H5', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 银联扫码', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 快捷支付', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 接口', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('文凭', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 学位证', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 学历', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 毕业证', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 证书', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('猫池', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 池', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('查通话记录', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 查微信记录', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 聊天记录', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 短信内容', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('网吧', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 增值', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' TR', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('返佣', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('羊毛', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        (' 吃货', 0, 0, '2024-07-18 20:55:26', '2024-07-18 20:55:26'),
        ('菠菜', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 出千', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 埋雷', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 猪蹄', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 内料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 外料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 轨道料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 下料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 洗料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 洗拦截料', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 挂马', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 刷货', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 鹅场', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 猫场', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('水房', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 声佬', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 刷机佬', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 接数佬', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 卡佬', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 车手', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('马', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 抓马', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 垫蓝', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('色粉', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 站街', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 号商', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 键盘手', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 养火花', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 机房', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 散键盘', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 出台', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 楼凤', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 做局', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('外宣', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 肥羊', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 主持', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 老师', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 干饭', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 稀饭', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('金主', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 菜商', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 卡农', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 话务员', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 话术本', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        ('信封', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 信封号', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 取信', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 洗信', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
        (' 二手信', 0, 0, '2024-07-18 20:56:53', '2024-07-18 20:56:53'),
    ]
    
    inserted_count = 0
    skipped_count = 0
    
    for keyword, status, is_delete, created_at, updated_at in keywords_data:
        # 检查是否已存在
        existing = BlackKeyword.query.filter_by(keyword=keyword).first()
        if existing:
            print(f"关键词 '{keyword}' 已存在，跳过")
            skipped_count += 1
            continue
            
        # 创建新记录
        new_keyword = BlackKeyword(
            keyword=keyword,
            status=status,
            is_delete=is_delete,
            created_at=datetime.strptime(created_at, '%Y-%m-%d %H:%M:%S'),
            updated_at=datetime.strptime(updated_at, '%Y-%m-%d %H:%M:%S')
        )
        
        try:
            db.session.add(new_keyword)
            db.session.commit()
            print(f"成功插入关键词: {keyword}")
            inserted_count += 1
        except Exception as e:
            db.session.rollback()
            print(f"插入关键词 '{keyword}' 失败: {e}")
    
    print(f"黑关键词插入完成！成功: {inserted_count}条, 跳过: {skipped_count}条")


def insert_result_tags():
    """插入结果标签数据"""
    print("开始插入结果标签数据...")
    
    # 从dml.sql提取的标签数据
    tags_data = [
        ('信件', 0, '2024-07-27 12:01:28', '2024-07-27 12:01:28'),
        ('烟油', 0, '2024-07-27 12:01:28', '2024-07-27 12:01:28'),
        ('色情', 0, '2024-07-27 12:01:28', '2024-07-27 12:01:28'),
        ('暴力', 0, '2024-07-27 12:01:28', '2024-07-27 12:01:28'),
        ('毒品', 0, '2024-07-27 12:01:28', '2024-07-27 12:01:28'),
        ('大麻', 0, '2024-07-27 12:04:57', '2024-07-27 12:04:57'),
    ]
    
    inserted_count = 0
    skipped_count = 0
    
    for title, status, created_at, updated_at in tags_data:
        # 检查是否已存在
        existing = ResultTag.query.filter_by(title=title).first()
        if existing:
            print(f"标签 '{title}' 已存在，跳过")
            skipped_count += 1
            continue
            
        # 创建新记录，使用默认颜色
        new_tag = ResultTag(
            title=title,
            status=status,
            created_at=datetime.strptime(created_at, '%Y-%m-%d %H:%M:%S'),
            updated_at=datetime.strptime(updated_at, '%Y-%m-%d %H:%M:%S')
        )
        
        try:
            db.session.add(new_tag)
            db.session.commit()
            print(f"成功插入标签: {title}")
            inserted_count += 1
        except Exception as e:
            db.session.rollback()
            print(f"插入标签 '{title}' 失败: {e}")
    
    print(f"结果标签插入完成！成功: {inserted_count}条, 跳过: {skipped_count}条")


def main():
    """主函数"""
    print("=" * 50)
    print("DML数据插入脚本")
    print("=" * 50)
    
    # 初始化Flask应用
    from jd import app
    app.ready(db_switch=True, web_switch=False, worker_switch=False)
    
    # 初始化Flask应用上下文
    with app.app_context():
        try:
            # 插入黑关键词
            insert_black_keywords()
            print()
            
            # 插入结果标签
            insert_result_tags()
            print()
            
            print("=" * 50)
            print("所有数据插入完成！")
            print("=" * 50)
            
        except Exception as e:
            print(f"执行过程中出现错误: {e}")
            db.session.rollback()


if __name__ == '__main__':
    main()